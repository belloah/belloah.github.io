<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title></title>
        <link>undefined</link>
        <description>undefined</description>
        <lastBuildDate>Wed, 16 Mar 2022 13:18:29 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>Joplin Pages Publisher</generator>
        <item>
            <title><![CDATA[係懶啊 - 改 Chromium Browser Bookmarks]]></title>
            <guid>66654b6ecd6f4508aaac62d8873718f0</guid>
            <pubDate>Wed, 16 Mar 2022 08:50:32 GMT</pubDate>
            <content:encoded><![CDATA[<h2 id="背景">背景</h2>
<p>基於我有啲極度唔安全嘅習慣，我想做到批量改 bookmark 嘅效果，但成品相當奇怪 :0)</p>
<p>目標係我 save 咗大量 bookmark 嘅 Brave, btw 佢嗰嚿所謂 Sync Code 相當 kam, 一郁 LOCALAPPDATA 個 userdata 就會收佢皮</p>
<p>今次改 Bookmarks 都唔例外，講緊嘅係 <code>"%LOCALAPPDATA%\BraveSoftware\Brave-Browser\User Data\(Profile 名，通常叫 Default)\Bookmarks"</code></p>
<h2 id="手段">手段</h2>
<p>PowerShell 7</p>
<h2 id="理想">理想</h2>
<p>首先我 quit Brave 先</p>
<div><pre class="hljs"><code><span class="hljs-comment"># To close Brave before editing Bookmarks in LOCALAPPDATA</span>
<span class="hljs-keyword">if</span> (<span class="hljs-built_in">Get-Process</span> <span class="hljs-literal">-Name</span> brave <span class="hljs-literal">-ErrorAction</span> Ignore) {
    <span class="hljs-variable">$options</span> = [<span class="hljs-type">System.Management.Automation.Host.ChoiceDescription</span>[]] <span class="hljs-selector-tag">@</span>(<span class="hljs-string">"&amp;Continue"</span>, <span class="hljs-string">"OH &amp;NO!"</span>)
    <span class="hljs-variable">$choice</span> = <span class="hljs-variable">$Host</span>.UI.PromptForChoice(<span class="hljs-string">"Save all works in Brave before continue"</span>, <span class="hljs-string">""</span>, <span class="hljs-variable">$options</span>, <span class="hljs-number">0</span>)
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$choice</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">0</span>) {
        TASKKILL /IM brave.exe &gt;nul <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>
        <span class="hljs-built_in">Write-Progress</span> <span class="hljs-literal">-Activity</span> <span class="hljs-string">"Closing"</span> <span class="hljs-literal">-Status</span> <span class="hljs-string">"Wait for Brave to close"</span> <span class="hljs-literal">-PercentComplete</span> <span class="hljs-number">100</span>;
        <span class="hljs-built_in">Wait-Process</span> <span class="hljs-literal">-Name</span> brave <span class="hljs-literal">-ErrorAction</span> Ignore
        <span class="hljs-built_in">Write-Progress</span> <span class="hljs-literal">-Activity</span> <span class="hljs-string">"Closing"</span> <span class="hljs-literal">-Completed</span>
    }
    <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"Please try again"</span> <span class="hljs-literal">-ForegroundColor</span> Yellow
        <span class="hljs-keyword">break</span>
    }
}</code></pre></div>
<p>之後就改 Bookmarks 入面啲嘢</p>
<div><pre class="hljs"><code><span class="hljs-comment"># Change Minions in Bookmarks</span>
<span class="hljs-variable">$path</span> = <span class="hljs-string">"<span class="hljs-variable">$env:LOCALAPPDATA</span>\BraveSoftware\Brave-Browser\User Data\Default\Bookmarks"</span>
<span class="hljs-comment"># Save a copy of Bookmarks to Downloads</span>
<span class="hljs-built_in">Copy-Item</span> <span class="hljs-variable">$path</span> <span class="hljs-literal">-Destination</span> <span class="hljs-string">"<span class="hljs-variable">$HOME</span>\Downloads\Bookmarks<span class="hljs-variable">$</span>(Get-Date -Format "</span>yyyyMMdd<span class="hljs-string">")"</span>
<span class="hljs-comment"># Overwrite the current Bookmarks</span>
<span class="hljs-variable">$bookmarks</span> = (<span class="hljs-built_in">Get-Content</span> <span class="hljs-variable">$path</span>) <span class="hljs-operator">-replace</span> <span class="hljs-variable">$oldminion</span>, <span class="hljs-variable">$newminion</span>
<span class="hljs-variable">$bookmarks</span> | <span class="hljs-built_in">Out-File</span> <span class="hljs-variable">$path</span></code></pre></div>
<h2 id="現實">現實</h2>
<p>以下係效果演示</p>
<p>開 Default Profile</p>
<p><img src="/_resources/f0457d0735b34f4b94015488ba0ea5f5.png" /></p>
<p>我正常地起咗個 bookmark 叫 “Testing Minion”</p>
<p><img src="/_resources/0b25aa9fadb14c738859ef0290c145e2.png" /></p>
<p>好啦，其實都唔是太正常，確認一下 tada 只得一個</p>
<p><img src="/_resources/e8a38715094b4cf189b29f4a5befdfe3.png" /></p>
<p>之後我就開始改，我要將 tada 變成 mebanana, 發現原來另一個位都有 tada, 差啲就賴嘢</p>
<p><img src="/_resources/fae626415f7c489885b42666164d6400.png" /></p>
<p>咁唯有喺前面加一/</p>
<p><img src="/_resources/ba7d78d05d244cf49e84baacaf5812a0.png" /></p>
<p>應該就剩返一個 tada</p>
<p><img src="/_resources/56ce577ac2734fffaec06e00e6cf246b.png" /></p>
<p>mebanana</p>
<p><img src="/_resources/1405a41a887349e48d52ce2496dcd12b.png" /></p>
<p>確認好就 overwrite (Brave is closed)</p>
<p><img src="/_resources/ba0b3f00958a40faba83a2da657031a0.png" /></p>
<p>之後就開返 Brave, 喺原本嗰個 bookmark 嘅 folder 會出現多一個同名嘅 bookmark :0)</p>
<p><img src="/_resources/72cc240fa5e94708b4d82da5a7d80e00.png" /></p>
<p>一個係 mebanana, 一個係 tada</p>
<p><img src="/_resources/ef30a9a8419e4cdc8f28e222f8109bb0.png" /></p>
<p>Autocomplete suppose 會拎返常用啲嗰個，因為呢隻 bookmark 冇用過，所以喺呢度 dem 唔到，實際情況排第一係舊嗰個</p>
<p><img src="/_resources/901e603342ea4f359233f20d82e594aa.png" /></p>
<p>搞咁大壇嘢都係拎返舊嗰個 bookmark, 哭𠹌咗</p>
<p>- 完 -</p>
<h2 id="後記">後記</h2>
<p>我睇到 under 我 profile 嘅 folder, 有 Bookmarks 同 Bookmark.bak, 未知係咪關事</p>
<p><img src="/_resources/1d6835d9cbe445e78a076ff6ecccf840.png" /></p>
<p>同埋未試開住 Brave 畀唔畀改個 file, 今日好嬲，冇心情試。下次再見！</p>
<p>- 真係完 -</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[係懶啊 - 改 Domain Account Password]]></title>
            <guid>7735a33db3d94669994953f13ddfbe48</guid>
            <pubDate>Wed, 16 Mar 2022 07:45:46 GMT</pubDate>
            <content:encoded><![CDATA[<h2 id="背景">背景</h2>
<p>今日見到password 就嚟過期，試用 PowerShell RSAT Module 幫自己 domain admin 改 password</p>
<h2 id="手段">手段</h2>
<ul>
<li>PowerShell 7</li>
<li>Windows FOD RSAT</li>
</ul>
<h2 id="理想">理想</h2>
<p>喺一個 domain user profile 嘅 PowerShell 7 console (with RSAT installed) 行類似咁嘅嘢：</p>
<div><pre class="hljs"><code><span class="hljs-variable">$dadomainadmin</span> = <span class="hljs-built_in">Get-Credential</span>
<span class="hljs-variable">$oldminion</span> = <span class="hljs-built_in">Read-Host</span> <span class="hljs-literal">-AsSecureString</span>
<span class="hljs-variable">$minion</span> = <span class="hljs-built_in">Read-Host</span> <span class="hljs-literal">-AsSecureString</span>
<span class="hljs-built_in">Get-ADUser</span> dadomainadmin | <span class="hljs-built_in">Set-ADAccountPassword</span> <span class="hljs-literal">-Credential</span> <span class="hljs-variable">$dadomainadmin</span> <span class="hljs-literal">-NewPassword</span> <span class="hljs-variable">$minion</span> <span class="hljs-literal">-OldPassword</span> <span class="hljs-variable">$oldminion</span></code></pre></div>
<h2 id="現實">現實</h2>
<p>成功~ 似乎係相當於密碼未過期前(PasswordExpired=False) change password 嘅步驟（啫係 Ctrl+Alt+Del 嗰啲正常嘢）</p>
<p>不過未研究 <code>-Reset</code> 取代 <code>-OldPassword</code> 係咪可行，同埋兩者對其他 attributes 嘅影響同 restrictions 有咩分別</p>
<p>例如係公司入面一日唔可以改(change) 密碼超過一次之類嗰啲，套咗落去用 <code>-OldPassword</code> 會唔會炒，又或者係 PasswordExpired=True 是咪一定要用 <code>-Reset</code></p>
<p>始終 domain admin 係搵食工具嚟，萬一試到要不停搞到同事就唔是咁好啦 :0)</p>
<p><del class="jop-noMdConv">或者搵日得閒拎個 domain user 嚟試下（其實仲大鑊） :0)</del></p>
<p>- 完 -</p>
]]></content:encoded>
        </item>
    </channel>
</rss>