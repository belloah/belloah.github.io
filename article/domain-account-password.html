<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        係懶啊 - 改 Domain Account Password - Belloah
    </title>
    <link rel="stylesheet" href="/_assets/style.css">
<link rel="stylesheet" href="/_markdown_plugin_assets/highlight.js/atom-one-light.css" /></head>

<body>
    <div class="main">
        <nav class="navigation">
            <a href="/">
                
            </a>
        </nav>
        <article>
            <header>
                <h1>
                    係懶啊 - 改 Domain Account Password
                </h1>
                <div class="article-info">
                    <div>
                        <span>Created At:<time datetime="1647416746601">
                                2022-03-16T15:45:46+08:00
                            </time></span>
                        <span>Updated At:<time datetime="1647430773473">
                                2022-03-16T19:39:33+08:00
                            </time></span>
                    </div>
                    
                        <div>
                            Keywords: 
                                <span class="keyword">
                                    activedirectory
                                </span>
                                
                                <span class="keyword">
                                    rsat
                                </span>
                                
                                <span class="keyword">
                                    powershell
                                </span>
                                
                        </div>
                        
                </div>
            </header>
            <div class="article-content markdown-body">
                <h2 id="背景">背景</h2>
<p>今日見到password 就嚟過期，試用 PowerShell RSAT Module 幫自己 domain admin 改 password</p>
<h2 id="手段">手段</h2>
<ul>
<li>PowerShell 7</li>
<li>Windows FOD RSAT</li>
</ul>
<h2 id="理想">理想</h2>
<p>喺一個 domain user profile 嘅 PowerShell 7 console (with RSAT installed) 行類似咁嘅嘢：</p>
<div><pre class="hljs"><code><span class="hljs-variable">$dadomainadmin</span> = <span class="hljs-built_in">Get-Credential</span>
<span class="hljs-variable">$oldminion</span> = <span class="hljs-built_in">Read-Host</span> <span class="hljs-literal">-AsSecureString</span>
<span class="hljs-variable">$minion</span> = <span class="hljs-built_in">Read-Host</span> <span class="hljs-literal">-AsSecureString</span>
<span class="hljs-built_in">Get-ADUser</span> dadomainadmin | <span class="hljs-built_in">Set-ADAccountPassword</span> <span class="hljs-literal">-Credential</span> <span class="hljs-variable">$dadomainadmin</span> <span class="hljs-literal">-NewPassword</span> <span class="hljs-variable">$minion</span> <span class="hljs-literal">-OldPassword</span> <span class="hljs-variable">$oldminion</span></code></pre></div>
<h2 id="現實">現實</h2>
<p>成功~ 似乎係相當於密碼未過期前(PasswordExpired=False) change password 嘅步驟（啫係 Ctrl+Alt+Del 嗰啲正常嘢）</p>
<p>不過未研究 <code>-Reset</code> 取代 <code>-OldPassword</code> 係咪可行，同埋兩者對其他 attributes 嘅影響同 restrictions 有咩分別</p>
<p>例如係公司入面一日唔可以改(change) 密碼超過一次之類嗰啲，套咗落去用 <code>-OldPassword</code> 會唔會炒，又或者係 PasswordExpired=True 是咪一定要用 <code>-Reset</code></p>
<p>始終 domain admin 係搵食工具嚟，萬一試到要不停搞到同事就唔是咁好啦 :0)</p>
<p><del class="jop-noMdConv">或者搵日得閒拎個 domain user 嚟試下（其實仲大鑊） :0)</del></p>
<p>- 完 -</p>

            </div>
        </article>
    </div>
</body>

</html>